---
title: 쉽게 풀어 쓴 Spring Security 아키텍처
description: Servlet과 Reactive 환경에 따른 Spring Security의 작동 방식을 알아봅니다.
image: '/images/series/spring-security/1-basic-concepts/cover.png'
tags:
  - spring
  - spring security
  - servlet
  - reactive
  - webflux
date: 2024-09-23 16:42:42
isDraft: true
isFeatured: true
---

> **해당 문서와 관련된 코드는 <a style={{color: "grey"}} href="https://github.com/nfl1ryxditimo12/spring-templates/" target="\_blank" rel="noopener noreferrer">링크</a>를 참고해주세요.**
>
> **Spring Security 시리즈는 아래 버전을 기준으로 작성되었습니다.**
>
> - jdk: corretto-21
> - spring boot: 3.3.4 <a style={{color: "grey"}} href="https://spring.io/projects/spring-boot#support" target="\_blank" rel="noopener noreferrer">[support]</a>
> - spring security: 6.3.3 <a style={{color: "grey"}} href="https://spring.io/projects/spring-security#support" target="\_blank" rel="noopener noreferrer">[support]</a>

---

> ## 글을 시작하며

Spring Security에서 인증, 인가 등 보안 관련 기능을 처리하기 위해 내부적인 작동이 어떻게 이뤄질까요?

이번 글에서는 Servlet 환경을 기준으로 한 Spring Security의 Filtering에 대해 알아보겠습니다.

<br />

## 1. 스프링의 HTTP 통신 과정

---

Spring Security를 설명하기 앞서, 스프링의 HTTP 통신 과정을 간단히 알아보겠습니다.

![Servlet 구조](/images/series/spring-security/1-basic-concepts/servlet-structure.png)

스프링은 HTTP 통신을 위해 서블릿이라는 기술을 사용합니다.
위 사진의 Web Context가 서블릿 영역으로, 서블릿 컨테이너는 클라이언트의 요청을 받아 DispatcherServlet을 통해 Spring Context로 HTTP 요청을 전달합니다.

<br />

#### 알아두면 좋은 내용

- 서블릿과 서블릿 컨테이너는 추상적인 개념으로, 스프링에서 HTTP 통신을 쉽게 돕는 역할을 합니다. 서블릿 컨테이너는 서블릿의 생명주기를 관리하며, HTTP 요청을 받아 서블릿으로 전달합니다.
- 서블릿의 구현체는 HttpServlet이며, 이를 상속한 DispatcherServlet이라는 자바 클래스가 주로 사용됩니다. DispatcherServlet은 url 기반 라우팅을 지원하여 요청을 적절한 Controller로 전달합니다.
- 서블릿 컨테이너의 구현체로는 톰캣, 제티 등이 존재하며, HTTP 요청을 받고 메세지를 파싱하여 HttpServletRequest, HttpServletResponse 객체로 변환하는 과정을 담당하기도 합니다.

<br/ >

#### 스프링이 HTTP 요청을 처리하는 순서를 요약하면 다음과 같습니다.

1. 클라이언트가 HTTP 요청을 서버에 전송합니다.
2. Servlet Container에서 요청을 읽어 HttpServletRequest, HttpServletResponse 객체로 변환 및 생성합니다.
3. Spring Context에 데이터를 전달하기 전, Servlet FilterChain을 실행합니다.
   - FilterChain은 빈으로 등록된 Filter들을 순차적으로 실행합니다.
4. Filter Chain이 완료된 후 HTTP Message를 Dispatcher Servlet으로 전달합니다.
5. Dispatcher Servlet은 url 기반 라우팅을 통해 Controller로 요청을 전달합니다.
6. 비즈니스 로직 수행 후 생성된 HTTP 응답을 Servlet Container를 통해 클라이언트로 응답합니다.

<br />

## 2. FilterChain으로 알아보는 스프링 시큐리티의 작동 방식

---

### FilterChain이란?

asdf

### FilterChain의 구조

스프링 시큐리티는 서블릿 Filter를 기반으로 동작하기 때문에, 일반적인 FilterChain의 과정을 함께 살펴보면 이해가 쉬워집니다. 아래 이미지는 [스프링 HTTP 통신 과정](#스프링이-http-요청을-처리하는-순서를-요약하면-다음과-같습니다)의 3번째 단계인 FilterChain의 세부 과정을 나타낸 것입니다.

![FilterChain 구조](/images/series/spring-security/1-basic-concepts/filterchain.png)

Servlet Container의 HTTP 요청 전처리 과정이 완료된 후 FilterChain이 실행됩니다. FilterChain은 미리 정의된 Filter들을 순차적으로 실행합니다.

Filter가 실행되는 위치는 컨텍스트가 달라 스프링 빈을 이용할 수 없어 인코딩, 데이터 파싱, 로깅 등 간단한 목적으로 사용됩니다. 하지만 **DelegatingFilterProxy를 이용하면, 스프링 컨텍스트에 접근이 가능해** 스프링 빈을 사용할 수 있습니다. 이런 유연함을 이용해 스프링 시큐리티는 인증, 인가, 보안 관련 기능을 처리하기도 합니다.

이 FilterChain 과정이 완료되면 DispatcherServlet이 실행되어 Controller로 요청이 전달됩니다.

<br />

## 3. 스프링 시큐리티를 이용한 보안 처리

---

<br />

## 4. 스프링 시큐리티를 잘 활용하기 위한 방법

---

<br />
